<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Asignación Óptima de Jobs a Clusters Computacionales</title>
    <script src="optimal-assignment.js"></script>
    <script>
          var Module = {
            onRuntimeInitialized: function() {
                console.log("El archivo wasm se ha cargado correctamente.");
            }
        };
        
        function runOptimalAssignment() {
            // Obtener los datos de entrada del formulario
            var N = parseInt(document.getElementById("numJobs").value);
            var jobs = document.getElementById("jobDurations").value.split(",").map(function(x){ return parseInt(x); });
            var M = parseInt(document.getElementById("numClusters").value);

            // Ejecutar la función findOptimalAssignment del archivo wasm
            console.log(Module)
            var result = Module.ccall('findOptimalAssignment', // Nombre de la función
                                      'number', // Tipo de retorno
                                      ['number', 'array', 'number', 'array'], // Tipos de los argumentos
                                      [N, jobs, M, new Array(N * M)]); // Valores de los argumentos

            // Mostrar el resultado en la página
            var outputDiv = document.getElementById("output");
            outputDiv.innerHTML = "";
            for (var i = 0; i < M; i++) {
                outputDiv.innerHTML += "<p>Cluster " + (i+1) + ": " + result.slice(i*N, (i+1)*N).join(", ") + "</p>";
            }
        }
    </script>
</head>
<body>
    <h1>Asignación Óptima de Jobs a Clusters Computacionales</h1>
    <form>
        <label for="numJobs">Número de trabajos:</label>
        <input type="number" id="numJobs" value="5"><br>
        <label for="jobDurations">Duración de cada trabajo (separado por comas):</label>
        <input type="text" id="jobDurations" value="30,50,10,20,90"><br>
        <label for="numClusters">Número de clusters:</label>
        <input type="number" id="numClusters" value="2"><br>
        <input type="button" value="Calcular asignación óptima" onclick="runOptimalAssignment()">
    </form>
    <div id="output"></div>
</body>
</html>
